<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>F&S飛翔旅行 | 加拿大東岸 & 芝加哥探索之旅</title>
    
    <!-- PWA Manifest and Theme Color -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="F&S飛翔旅行">
    <meta name="theme-color" content="#4f46e5">
    <link rel="manifest" href="data:application/manifest+json;base64,ew0KICAic2hvcnRfbmFtZSI6ICJGJlPkvZXlvLpUSEsiLA0KICAibmFtZSI6ICJGJlPkvZXlvLpUSEsiLCANCiAgImljb25zIjogWw0KICAgIHsNCiAgICAgICJzcmMiOiAiaHR0cHM6Ly9wbGFjZWhvbGQuY28vMTkyeDE5Mi80ZjQ2ZTUvZmZmZmZmP3RleHQ9RlMlMjZTIiwNCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIsDQogICAgICAic2l6ZXMiOiAiMTkyeDE5MiINCiAgICB9LA0KICAgIHsNCiAgICAgICJzcmMiOiAiaHR0cHM6Ly9wbGFjZWhvbGQuY28vNTEyeDUxMi80ZjQ2ZTUvZmZmZmZmP3RleHQ9RlMlMjZTIiwNCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIsDQogICAgICAic2l6ZXMiOiAiNTEyeDUxMiINCiAgICB9DQogIF0sDQogICJzdGFydF91cmwiOiAiLiIsDQogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLA0KICAidGhlbWVfY29sb3IiOiAiI0NGY0NmU1IiwNCiAgImJhY2tncm91bmRfY29sb3IiOiAiI2Y4ZjlmYSIgDQp9">
    <link rel="apple-touch-icon" href="https://placehold.co/180x180/4f46e5/ffffff?text=F%26S">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand-color: #4f46e5;
            --brand-color-light: #eef2ff;
        }
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: #f8f9fa;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }
        h1, h2, h3 { font-family: 'Noto Sans TC', sans-serif; font-weight: 900; }
        
        .trip-card {
            border: 1px solid #e5e7eb;
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .trip-card.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        .trip-card:hover {
            transform: translateY(-5px) !important;
            box-shadow: 0 10px 20px rgba(0,0,0,0.08), 0 6px 6px rgba(0,0,0,0.1);
        }
        
        /* Animation for Activity Blocks */
        .activity-block {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.4s ease-out, transform 0.4s ease-out;
        }

        .is-visible .activity-block {
            opacity: 1;
            transform: translateY(0);
        }

        .sticky-nav {
            position: sticky;
            top: env(safe-area-inset-top);
            z-index: 50;
            transition: box-shadow 0.3s;
        }
        .sticky-nav.scrolled {
             box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }

        .tag { display: inline-block; background-color: var(--brand-color-light); color: #4338ca; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.8rem; font-weight: 500; margin-right: 0.5rem; margin-bottom: 0.5rem; }
        
        .activity-block a {
            font-weight: 600; /* semibold */
            color: #4338ca; /* indigo-700 */
        }
        
        details > summary { 
            list-style: none; 
            cursor: pointer; 
            padding: 1rem 1.25rem;
            transition: background-color 0.3s ease;
        }
        details > summary::-webkit-details-marker { display: none; }
        details .summary-arrow { transition: transform 0.3s; }
        details[open] > summary .summary-arrow { transform: rotate(90deg); }

        summary.summary-travel-day {
            background-color: #fffbeb;
            border-radius: 1rem;
            border: 1px solid #fef3c7;
        }
        summary.summary-travel-day h3 {
            color: #92400e;
        }
        
        summary.summary-today {
            background-color: #f0fdf4;
            border-radius: 1rem;
            border: 2px solid #4ade80;
            position: relative;
        }
        summary.summary-today h3::before {
             content: '⭐';
             margin-right: 0.5rem;
        }

        .weather-display {
            font-size: 0.8rem;
            color: #6b7280;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.7;
            }
        }

        /* --- Map Interaction Styles --- */
        .map-city-link:hover g .map-city-dot, .map-city-link:active g .map-city-dot {
            r: 7;
            fill: #f43f5e; /* rose-500 */
        }
        .map-city-link:hover g text, .map-city-link:active g text {
            font-weight: bold;
        }
        
        .map-city-active g .map-city-dot {
            r: 8;
            fill: #ef4444; /* red-500 */
            stroke: rgba(255, 255, 255, 0.7);
            stroke-width: 1.5px;
        }
        .map-city-active g text {
            font-weight: bold;
            fill: #ef4444;
        }

        .map-city-current g .map-city-dot {
            r: 9;
            fill: #f59e0b; /* amber-500 */
            stroke: white;
            stroke-width: 2px;
            animation: pulse 2s infinite;
        }
        .map-city-current g text {
            font-weight: 900; /* black */
            font-size: 11px;
            fill: #d97706; /* amber-600 */
        }
        
        .route-line {
            stroke: #fb923c;
            stroke-width: 2.5px;
            stroke-dasharray: 5 3;
            fill: none;
            stroke-linecap: round;
            transition: all 0.3s ease-in-out;
        }
        .route-line.highlight, .route-line.highlight-scroll {
            stroke: #ef4444;
            stroke-width: 4px;
            stroke-dasharray: none;
        }

        .transport-icon {
            opacity: 0;
            animation: fadeIn 1s ease-in forwards;
            animation-delay: 2s;
        }
        .animated-route {
            stroke-dasharray: 500;
            stroke-dashoffset: 500;
            animation: draw 2s ease-out forwards;
        }
        
        @keyframes draw { to { stroke-dashoffset: 0; } }
        @keyframes fadeIn { to { opacity: 1; } }

        .nav-pill-group {
            display: inline-flex;
            align-items: center;
            background-color: #e5e7eb;
            border-radius: 9999px;
            padding: 0.25rem;
        }
        .nav-pill {
            padding: 0.375rem 1rem;
            font-size: 0.875rem;
            font-weight: 500;
            color: #4b5563;
            border-radius: 9999px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .nav-pill.active {
            background-color: white;
            color: var(--brand-color);
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        .nav-link {
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
        }
        .nav-link.nav-link-active {
            color: var(--brand-color);
            border-bottom-color: var(--brand-color);
        }

        .timezone-block {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .timezone-highlight {
            transform: scale(1.03);
            box-shadow: 0 0 0 3px var(--brand-color);
            background-color: #f0f9ff;
        }
        .day-past {
            display: none;
        }
        .show-past .day-past {
            display: block;
        }
        
        @media print {
            @page { 
                size: A4 portrait; 
                margin: 1cm;
            }
            body { 
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact; 
            }
            .no-print, .sticky-nav, #today-btn, #mobile-menu-btn, #time-dashboard { 
                display: none !important; 
            }
            .trip-card, .trip-card.is-visible { 
                box-shadow: none !important; 
                border: 1px solid #e5e7eb !important; 
                page-break-inside: avoid; 
                opacity: 1 !important; 
                transform: none !important; 
            }
            .activity-block {
                opacity: 1 !important;
                transform: none !important;
            }
            main { 
                border-left: none !important; 
                padding-left: 0 !important; 
                margin-left: 0 !important; 
            }
            details { 
                page-break-inside: avoid; 
            }
            details summary .summary-arrow { 
                display: none !important; 
            }
            .day-past {
                display: block !important;
            }
        }
    </style>
</head>
<body class="text-gray-800 leading-relaxed">

    <!-- Sticky Navigation Bar -->
    <nav id="main-nav" class="sticky-nav bg-white/80 backdrop-blur-lg no-print">
        <div class="container mx-auto max-w-6xl px-4">
            <div class="flex justify-between items-center py-3">
                <span class="font-bold text-base sm:text-lg text-indigo-700">F＆S飛翔旅行</span>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:flex flex-grow justify-center items-center space-x-6 text-sm font-medium">
                    <div id="desktop-nav-pills" class="nav-pill-group">
                        <div class="nav-pill active" data-tab="days">按天數</div>
                        <div class="nav-pill" data-tab="cities">按城市</div>
                    </div>
                    <div id="desktop-nav-content-days" class="flex items-center space-x-4">
                        <a href="#day1" data-navlink-day="1" class="py-2 nav-link">Day 1-2</a>
                        <a href="#day3" data-navlink-day="3" class="py-2 nav-link">Day 3-4</a>
                        <a href="#day5" data-navlink-day="5" class="py-2 nav-link">Day 5-6</a>
                        <a href="#day7" data-navlink-day="7" class="py-2 nav-link">Day 7-9</a>
                        <a href="#day10" data-navlink-day="10" class="py-2 nav-link">Day 10-14</a>
                    </div>
                    <div id="desktop-nav-content-cities" class="hidden space-x-4">
                        <a href="#montreal-section" data-navlink-city="montreal-section" class="py-2 nav-link">蒙特婁</a>
                        <a href="#quebec-section" data-navlink-city="quebec-section" class="py-2 nav-link">魁北克市</a>
                        <a href="#niagara-section" data-navlink-city="niagara-section" class="py-2 nav-link">尼加拉瀑布</a>
                        <a href="#chicago-section" data-navlink-city="chicago-section" class="py-2 nav-link">芝加哥</a>
                    </div>
                </div>
                 <div class="hidden md:flex items-center space-x-4 text-sm">
                    <a href="#tip-calculator-section" class="nav-utils py-2 text-gray-600 hover:text-indigo-700 transition-colors">🧮 小費計算</a>
                    <a href="#links-dashboard" class="nav-utils py-2 text-gray-600 hover:text-indigo-700 transition-colors">🔗 常用連結</a>
                    <button id="print-btn" class="no-print inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" /></svg>
                        列印行程
                    </button>
                </div>

                <!-- Mobile Navigation: Hamburger Button -->
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Navigation Panel -->
        <div id="mobile-menu-panel" class="md:hidden hidden bg-white shadow-lg">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#day1" class="mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">Day 1-2 (蒙特婁)</a>
                <a href="#day3" class="mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">Day 3-4 (魁北克)</a>
                <a href="#day5" class="mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">Day 5-6 (尼加拉)</a>
                <a href="#day7" class="mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">Day 7-9 (芝加哥)</a>
                <a href="#day10" class="mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">Day 10-14 (返程)</a>
            </div>
            <div class="pt-4 pb-3 border-t border-gray-200">
                <div class="px-2 space-y-1">
                    <a href="#tip-calculator-section" class="mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">🧮 小費計算機</a>
                    <a href="#links-dashboard" class="mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">🔗 常用連結</a>
                    <button id="mobile-print-btn" class="w-full text-left mobile-nav-link block px-3 py-3 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-gray-50">📄 列印行程</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-6xl">
        
        <!-- Live Time Dashboard -->
        <section id="time-dashboard" class="mb-12 no-print">
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                <div id="time-montreal-block" class="timezone-block bg-white p-4 rounded-lg shadow text-center">
                    <h2 class="text-sm font-bold text-gray-500">🍁 蒙特婁/魁北克</h2>
                    <p id="time-montreal" class="text-xl sm:text-2xl font-mono font-bold text-gray-800">--:--:--</p>
                    <p id="date-montreal" class="text-xs text-gray-400">---</p>
                </div>
                <div id="time-chicago-block" class="timezone-block bg-white p-4 rounded-lg shadow text-center">
                    <h2 class="text-sm font-bold text-gray-500">🇺🇸 芝加哥</h2>
                    <p id="time-chicago" class="text-xl sm:text-2xl font-mono font-bold text-gray-800">--:--:--</p>
                    <p id="date-chicago" class="text-xs text-gray-400">---</p>
                </div>
                 <div id="time-taipei-block" class="timezone-block bg-white p-4 rounded-lg shadow text-center">
                    <h2 class="text-sm font-bold text-gray-500">🇹🇼 台北</h2>
                    <p id="time-taipei" class="text-xl sm:text-2xl font-mono font-bold text-gray-800">--:--:--</p>
                    <p id="date-taipei" class="text-xs text-gray-400">---</p>
                </div>
            </div>
        </section>

        <!-- Itinerary Overview Map -->
        <section class="mb-12 sm:mb-16 bg-white rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 ring-1 ring-gray-200 trip-card">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6 text-gray-900 flex items-center">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mr-3 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 16.382V5.618a1 1 0 00-1.447-.894L15 7m0 13V7m0 13L9 7" /></svg>
                行程總覽地圖
            </h2>
            <div class="w-full bg-gray-50 rounded-lg p-2 sm:p-4 border">
                 <svg viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg" class="w-full h-auto">
                    <!-- Beautified Background -->
                    <path d="M 20 170 Q 150 180 250 130 T 380 110" stroke="#cae8ff" stroke-width="15" fill="none" stroke-linecap="round" />
                    <text x="25" y="185" font-size="8" fill="#5b95c2" font-weight="bold">聖羅倫斯河</text>
                    <path d="M 240 135 C 200 110, 150 100, 100 115" stroke="#cae8ff" stroke-width="25" fill="none" stroke-linecap="round" />
                    <text x="140" y="105" font-size="8" fill="#5b95c2" font-weight="bold">安大略湖</text>
                    
                    <!-- Animated Route Lines -->
                    <g id="map-routes">
                        <path id="path-qc-mtl" class="route-line animated-route" d="M350 115 L 290 125" style="animation-delay: 0s;"/>
                        <path id="path-qc-yyz" class="route-line animated-route" d="M350,115 A150,150 0 0,0 230,120" style="animation-delay: 0.5s;"/>
                        <path id="path-to-nf" class="route-line animated-route" d="M230 120 L 200 110" style="animation-delay: 1s;"/>
                        <path id="path-nf-chi" class="route-line animated-route" d="M200,110 A150,150 0 0,0 80,100" style="animation-delay: 1.5s;"/>
                    </g>
                    
                    <!-- Transport Icons -->
                    <g id="map-icons">
                        <text x="315" y="125" font-size="12" class="transport-icon" style="animation-delay: 1s;">🚄</text> <!-- Mtl-QC -->
                        <text x="285" y="100" font-size="12" class="transport-icon" style="animation-delay: 1.5s;">✈️</text> <!-- QC-TO -->
                        <text x="210" y="119" font-size="12" class="transport-icon" style="animation-delay: 2s;">🚌</text> <!-- TO-NF -->
                        <text x="135" y="90" font-size="12" class="transport-icon" style="animation-delay: 2.5s;">✈️</text> <!-- NF-CHI -->
                    </g>
                    
                    <!-- City Points -->
                    <a href="#quebec-section" class="map-city-link" data-city-id="quebec-section" data-path-id="path-qc-mtl,path-qc-yyz"><g class="cursor-pointer"><circle cx="350" cy="115" r="5" fill="#1d4ed8" class="map-city-dot"/><text x="355" y="110" font-size="10" fill="#333">魁北克市</text><text x="355" y="122" font-size="7" fill="#666">Day 3-4</text></g></a>
                    <a href="#montreal-section" class="map-city-link" data-city-id="montreal-section" data-path-id="path-qc-mtl"><g class="cursor-pointer"><circle cx="290" cy="125" r="5" fill="#1d4ed8" class="map-city-dot"/><text x="295" y="138" font-size="10" fill="#333">蒙特婁</text><text x="295" y="150" font-size="7" fill="#666">Day 1-2</text></g></a>
                    <a href="#niagara-section" class="map-city-link" data-city-id="niagara-section" data-path-id="path-qc-yyz,path-to-nf"><g class="cursor-pointer"><circle cx="230" cy="120" r="5" fill="#1d4ed8" class="map-city-dot"/><text x="235" y="115" font-size="10" fill="#333">多倫多</text><text x="235" y="127" font-size="7" fill="#666">(轉運)</text></g></a>
                    <a href="#niagara-section" class="map-city-link" data-city-id="niagara-section" data-path-id="path-to-nf,path-nf-chi"><g class="cursor-pointer"><circle cx="200" cy="110" r="5" fill="#1d4ed8" class="map-city-dot"/><text x="145" y="95" font-size="10" fill="#333">尼加拉瀑布</text><text x="175" y="122" font-size="7" fill="#666">Day 5-6</text></g></a>
                    <a href="#chicago-section" class="map-city-link" data-city-id="chicago-section" data-path-id="path-nf-chi"><g class="cursor-pointer"><circle cx="80" cy="100" r="5" fill="#1d4ed8" class="map-city-dot"/><text x="25" y="105" font-size="10" fill="#333">芝加哥</text><text x="25" y="117" font-size="7" fill="#666">Day 7-12</text></g></a>
                </svg>
            </div>
        </section>

        <!-- Past Itinerary Toggle Switch -->
        <div class="flex justify-end items-center mb-4 no-print">
            <label for="show-past-toggle" class="flex items-center cursor-pointer text-sm font-medium text-gray-700">
                <span class="mr-3">顯示過去行程</span>
                <div class="relative">
                    <input type="checkbox" id="show-past-toggle" class="sr-only peer">
                    <div class="block bg-gray-200 w-10 h-6 rounded-full peer-checked:bg-indigo-300 transition-colors"></div>
                    <div class="dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform peer-checked:translate-x-full"></div>
                </div>
            </label>
        </div>


        <!-- Itinerary Cards -->
        <main class="space-y-8">
            
            <section id="montreal-section" data-city-section="montreal-section" class="trip-card"></section>
            
            <div data-day="1" data-date="2025-07-02" data-day-group="1" data-city-target="montreal-section" data-weather-city="montreal">
                <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden" open>
                    <summary class="summary-travel-day flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-amber-700">Day 1｜7月2日（週三）</p>
                            <h3 id="day1" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">蒙特婁抵達日</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                        <div class="my-3"><span class="tag">#轉機抵達</span><span class="tag">#入境準備</span><span class="tag">#時差適應</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                 <h4 class="font-bold text-lg text-blue-800">✈️ 航班資訊與抵達安排</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>航班 BR198：</strong>台北松山(TSA) 09:00 起飛 → 東京成田(NRT) 13:25 抵達。</li>
                                    <li><strong>航班 AC6：</strong>東京成田(NRT) 17:35 起飛 → 蒙特婁(YUL) 17:00（同日）抵達。</li>
                                    <li>※ 因時差關係，會是“時光倒流”的感覺，但實際飛行時間約 12 小時。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🛂 抵達蒙特婁機場（YUL）</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>預計通關 + 行李提領時間：</strong>約 60–90 分鐘。</li>
                                    <li><strong>建議完成入境後先購買：</strong>📱 SIM 卡（推薦：Bell / Fido 櫃台）、🚇 STM 交通票券（單程票 or OPUS 3日卡）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🚕 前往市區飯店</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>747 Express Bus (24小時營運)：</strong>費用 CA$11，行程約 45–60 分鐘，可直接用信用卡刷進站。</li>
                                    <li><strong>Uber／Taxi：</strong>約 CA$45–55，車程約 30–40 分鐘。</li>
                                    <li><strong>飯店建議地點：</strong><a href="https://maps.apple.com/?q=Vieux-Montréal" target="_blank" class="hover:underline">Vieux-Montréal（舊城區）</a>或 <a href="https://maps.apple.com/?q=Berri-UQAM" target="_blank" class="hover:underline">Berri-UQAM／Quartier Latin</a>。</li>
                                </ul>
                            </div>
                             <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🌇 19:00–21:00 飯店安頓＋簡單夜間散步</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                     <li><strong>夕陽夜景路線：</strong>沿<a href="https://maps.apple.com/?q=Old+Port+of+Montreal" target="_blank" class="hover:underline">舊港</a>慢行至 <a href="https://maps.apple.com/?q=La+Grande+Roue+de+Montréal" target="_blank" class="hover:underline">La Grande Roue 摩天輪區</a>，看聖勞倫斯河夜景。</li>
                                     <li><strong>輕食建議：</strong><a href="https://maps.apple.com/?q=Olive+et+Gourmando" target="_blank" class="hover:underline">Olive et Gourmando</a> 或 <a href="https://maps.apple.com/?q=Maison+Christian+Faure" target="_blank" class="hover:underline">Maison Christian Faure</a>（甜點塔派）。</li>
                                </ul>
                            </div>
                             <div class="mt-4 p-4 bg-amber-100/60 rounded-lg border-l-4 border-amber-400">
                                <h4 class="font-bold text-amber-800 flex items-center mb-2">🌙 睡前提醒</h4>
                                <ul class="list-disc list-inside mt-2 text-amber-900/80 space-y-1">
                                    <li>🧴 建議泡澡放鬆，避免時差影響過大。</li>
                                    <li>🕓 盡量調整作息至當地時間，避免太早入睡。</li>
                                    <li>📦 可順便打開行李，準備第二天城市探索用物（行動網路、地鐵卡、備用雨具）。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
            <div data-day="2" data-date="2025-07-03" data-day-group="1" data-city-target="montreal-section" data-weather-city="montreal">
                <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 2｜7月3日（週四）</p>
                            <h3 id="day2" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">蒙特婁半日遊｜教堂・市集・港邊漫步</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                        <div class="my-3"><span class="tag">#哥德式教堂</span><span class="tag">#舊港漫步</span><span class="tag">#法式風情</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">☀️ 08:30 – 12:00｜舊城早晨巡禮</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>🏛️ <a href="https://maps.apple.com/?q=Notre-Dame+Basilica+of+Montreal" target="_blank" class="hover:underline">諾特丹聖母大教堂</a>：</strong>蒙特婁最具代表性的哥德式教堂。若有英文導覽團（$15 CAD左右）可預約參加。建議停留 40–60 分鐘。</li>
                                    <li><strong>🏙️ <a href="https://maps.apple.com/?q=Place+d'Armes,Montreal" target="_blank" class="hover:underline">Place d’Armes 廣場</a> → <a href="https://maps.apple.com/?q=Rue+Saint-Paul,Montreal" target="_blank" class="hover:underline">Rue Saint-Paul 步行街</a>：</strong>充滿法式殖民建築與街頭藝人，適合拍照、買紀念品。</li>
                                </ul>
                            </div>
                             <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🧺 12:00 – 13:30｜午餐 + 市集小吃</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong><a href="https://maps.apple.com/?q=Marché+Bonsecours,Montreal" target="_blank" class="hover:underline">Marché Bonsecours（邦斯古爾市場）</a>：</strong>藝品、手工皂、地方食品伴手禮選擇豐富。</li>
                                    <li><strong>或前往：</strong><a href="https://maps.apple.com/?q=Modavie,Montreal" target="_blank" class="hover:underline">Modavie Bistro</a>（音樂法餐）或 <a href="https://maps.apple.com/?q=Tommy+Café,Montreal" target="_blank" class="hover:underline">Tommy Café</a>（人氣咖啡店）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🛍️ 13:30 – 15:30｜舊港區港邊散步 + 摩天輪體驗</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>沿 <a href="https://maps.apple.com/?q=Old+Port+of+Montreal" target="_blank" class="hover:underline">Vieux-Port de Montréal</a> 河岸漫步，若天氣良好可搭乘 🎡 <a href="https://maps.apple.com/?q=La+Grande+Roue+de+Montréal" target="_blank" class="hover:underline">La Grande Roue 蒙特婁摩天輪</a>（$25 CAD 左右）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🧳 15:30 – 17:00｜飯店小憩・整理行李</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>回飯店稍作休息，或前往超市（如 IGA、Metro）補給。</li>
                                    <li>整理翌日轉往魁北克的行李（建議提前預訂 VIA Rail 火車）。</li>
                                </ul>
                            </div>
                             <div class="mt-4 p-4 bg-teal-100/60 rounded-lg border-l-4 border-teal-400">
                                <h4 class="font-bold text-teal-800 flex items-center mb-2">⭐ 蒙特婁實用資訊</h4>
                                <ul class="list-disc list-inside mt-2 text-teal-900/80 space-y-1">
                                    <li>💳 地鐵使用 STM 系統，一日票或 OPUS 卡皆可。</li>
                                    <li>🗣 雖以法語為主，但觀光區英文通用，用「Bonjour / Merci」開場更有禮。</li>
                                    <li>👟 鞋子請選擇適合步行的，舊城區石板路段多。</li>
                                    <li>🌤 七月天氣約 22–27°C，日夜溫差稍大，建議攜帶薄外套。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
            <section id="quebec-section" data-city-section="quebec-section" class="trip-card"></section>
            
            <div data-day="3" data-date="2025-07-04" data-day-group="3" data-city-target="quebec-section" data-weather-city="quebec">
                <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                     <summary class="summary-travel-day flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-amber-700">Day 3｜7月4日（週五）</p>
                            <h3 id="day3" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">蒙特婁 → 魁北克市｜VIA Rail 轉移・上城區初探</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                        <div class="my-3"><span class="tag">#火車旅程</span><span class="tag">#古城初探</span><span class="tag">#世界遺產</span></div>
                        <div class="space-y-6">
                             <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">🚄 07:30 – 12:00｜搭乘 VIA Rail 前往魁北克</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>早餐：</strong>可至 <a href="https://maps.apple.com/?q=Boulangerie+Première+Moisson,Montreal" target="_blank" class="hover:underline">Première Moisson</a> 外帶可頌＋咖啡。</li>
                                    <li>搭地鐵至 Bonaventure 站即達<a href="https://maps.apple.com/?q=Gare+Centrale,Montreal" target="_blank" class="hover:underline">中央火車站 (Gare Centrale)</a>。</li>
                                    <li><strong>建議班次 08:45 – 12:00：</strong>行程約 3 小時 15 分鐘，沿途欣賞鄉間景致。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🧳 12:00 – 13:30｜抵達魁北克市 → 入住飯店 → 午餐</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>抵達站：</strong><a href="https://maps.apple.com/?q=Gare+du+Palais,Quebec" target="_blank" class="hover:underline">Gare du Palais</a>，位於舊城區北側。</li>
                                    <li><strong>建議住宿區域：</strong>上城（Haute-Ville），靠近 <a href="https://maps.apple.com/?q=Fairmont+Le+Château+Frontenac,Quebec" target="_blank" class="hover:underline">Château Frontenac</a>。</li>
                                    <li><strong>午餐建議：</strong><a href="https://maps.apple.com/?q=Le+Chic+Shack,Quebec" target="_blank" class="hover:underline">Le Chic Shack</a>（漢堡＋奶昔）或 <a href="https://maps.apple.com/?q=Buffet+de+l’Antiquaire,Quebec" target="_blank" class="hover:underline">Buffet de l’Antiquaire</a>（魁北克家常菜）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                 <h4 class="font-bold text-lg text-purple-800">🏰 14:00 – 17:30｜上城區初探路線</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                     <li><strong>步行路線：</strong><a href="https://maps.apple.com/?q=Fairmont+Le+Château+Frontenac,Quebec" target="_blank" class="hover:underline">芳堤娜城堡</a> → <a href="https://maps.apple.com/?q=Dufferin+Terrace,Quebec" target="_blank" class="hover:underline">杜費林露台</a> → <a href="https://maps.apple.com/?q=Porte+Saint-Louis,Quebec" target="_blank" class="hover:underline">聖路易門/古城牆</a> → <a href="https://maps.apple.com/?q=Hôtel+du+Parlement,Quebec" target="_blank" class="hover:underline">魁北克省議會</a>。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🌃 18:00 – 20:30｜晚餐＋夜景散步</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>餐廳建議：</strong><a href="https://maps.apple.com/?q=Aux+Anciens+Canadiens,Quebec" target="_blank" class="hover:underline">Aux Anciens Canadiens</a> (17世紀老宅法餐)。</li>
                                    <li>飯後可再回到 Dufferin Terrace 拍攝夜景，芳堤娜城堡夜間打燈效果極佳。</li>
                                </ul>
                            </div>
                             <div class="mt-4 p-4 bg-amber-100/60 rounded-lg border-l-4 border-amber-400">
                                <h4 class="font-bold text-amber-800 flex items-center mb-2">🛏️ 睡前建議</h4>
                                <ul class="list-disc list-inside mt-2 text-amber-900/80 space-y-1">
                                    <li>若隔天為重度步行日，建議今晚簡單伸展、早點休息。</li>
                                    <li>可於便利商店購買簡易點心或隔日早餐儲備。</li>
                                    <li>如有興趣參加翌日付費導覽 (如鬼怪夜遊、歷史導覽)，可今晚先預約。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>

            <div data-day="4" data-date="2025-07-05" data-day-group="3" data-city-target="quebec-section" data-weather-city="quebec">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 4｜7月5日（週六）</p>
                            <h3 id="day4" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">魁北克市深度遊｜下城、博物館與觀景台</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                     <div class="p-4 sm:p-6 border-t border-gray-200">
                        <div class="my-3"><span class="tag">#小尚普蘭街</span><span class="tag">#文明博物館</span><span class="tag">#亞伯拉罕平原</span></div>
                         <div class="space-y-6">
                           <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">☀️ 08:30 – 12:00｜下城區漫步 + 文明博物館</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>搭乘<a href="https://maps.apple.com/?q=Funiculaire+du+Vieux-Québec" target="_blank" class="hover:underline">登山纜車</a>或走<a href="https://maps.apple.com/?q=Escalier+Casse-Cou,Quebec" target="_blank">斷頭階梯</a>前往下城。</li>
                                    <li>探索<a href="https://maps.apple.com/?q=Rue+du+Petit-Champlain,Quebec" target="_blank" class="hover:underline">小尚普蘭街</a>與<a href="https://maps.apple.com/?q=Place+Royale,Quebec" target="_blank" class="hover:underline">Place Royale 廣場</a>。</li>
                                    <li><strong>10:30 – 12:00：</strong>參觀<a href="https://www.mcq.org/en/" target="_blank" class="hover:underline">文明博物館 Musée de la civilisation</a> (建議預留 1.5 小時)。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🍽 12:00 – 13:30｜午餐時間</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>推薦餐廳：</strong><a href="https://maps.apple.com/?q=Le+Lapin+Sauté,Quebec" target="_blank" class="hover:underline">Le Lapin Sauté</a> (兔肉料理) 或 <a href="https://maps.apple.com/?q=Cochon+Dingue,Quebec" target="_blank" class="hover:underline">Cochon Dingue</a> (人氣早午餐)。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                 <h4 class="font-bold text-lg text-purple-800">🌳 14:00 – 17:00｜亞伯拉罕平原 + 城牆巡禮</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>沿<a href="https://maps.apple.com/?q=Promenade+des+Gouverneurs,Quebec+City" target="_blank" class="hover:underline">總督步道</a>進入<a href="https://maps.apple.com/?q=Plains+of+Abraham,Quebec" target="_blank" class="hover:underline">亞伯拉罕平原</a>。</li>
                                    <li>可參觀<a href="https://www.ccbn-nbc.gc.ca/en/plains-of-abraham/plains-of-abraham-museum/" target="_blank" class="hover:underline">平原博物館</a>，或在<a href="https://maps.apple.com/?q=Artillery+Park,Quebec" target="_blank" class="hover:underline">城牆(Artillery Park)</a>上散步。</li>
                                    <li><strong>備選：</strong><a href="https://www.observatoire-capitale.com/en/" target="_blank" class="hover:underline">Observatoire de la Capitale</a>（觀景台）俯瞰古城全景。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🍷 18:00 – 20:30｜晚餐與夜景收尾</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>晚餐建議：</strong><a href="https://maps.apple.com/?q=Chez+Boulay+–+Bistro+Boréal,Quebec" target="_blank" class="hover:underline">Chez Boulay – Bistro Boréal</a>（北方林地創意料理）。</li>
                                    <li>飯後可再次至 Dufferin Terrace 或 Place d’Armes 散步，感受古城夜間氛圍。</li>
                                </ul>
                            </div>
                             <div class="mt-4 p-4 bg-teal-100/60 rounded-lg border-l-4 border-teal-400">
                                <h4 class="font-bold text-teal-800 flex items-center mb-2">⭐ 魁北克市實用資訊</h4>
                                <ul class="list-disc list-inside mt-2 text-teal-900/80 space-y-1">
                                    <li>🗣 法語為主，但觀光區英文OK；標誌以法語為主。</li>
                                    <li>🚶‍♀️ 石板坡道多，建議穿防滑鞋、備手杖如有需要。</li>
                                    <li>💳 商店與餐廳普遍接受信用卡，小費建議 15–18%。</li>
                                    <li>🌤 白天氣溫約 22°C，夜間可降至 16°C，攜帶薄長袖外套。</li>
                                </ul>
                            </div>
                        </div>
                     </div>
                </details>
            </div>

            <section id="niagara-section" data-city-section="niagara-section" class="trip-card"></section>

            <div data-day="5" data-date="2025-07-06" data-day-group="5" data-city-target="niagara-section" data-weather-city="niagara">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="summary-travel-day flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-amber-700">Day 5｜7月6日（週日）</p>
                            <h3 id="day5" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">魁北克市 → 尼加拉瀑布｜悠閒出發 + 抵達觀景</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                        <div class="my-3"><span class="tag">#國內航班</span><span class="tag">#機場轉乘</span><span class="tag">#瀑布夜景</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">☕ 08:30 – 10:30｜早餐與最後散步</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>推薦早餐地點：</strong><a href="https://maps.apple.com/?q=Le+Cochon+Dingue,Quebec" target="_blank" class="hover:underline">Le Cochon Dingue</a> 或 <a href="https://maps.apple.com/?q=La+Maison+Smith,Quebec" target="_blank" class="hover:underline">La Maison Smith</a>。</li>
                                    <li>可選擇短距離散步（如 Place Royale 再訪、沿芳堤娜城堡拍照收尾）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">✈️ 11:00 – 14:30｜退房 → 前往機場 → 搭乘中午航班</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>建議搭乘航班如 Air Canada AC7959（13:00 YQB → 14:30 YYZ）或類似班次。</li>
                                    <li>從舊城至機場約 20–30 分鐘計程車程。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🚌 15:30 – 17:30｜轉乘至尼加拉瀑布</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>包車：</strong>約 1.5 小時直達飯店。</li>
                                    <li><strong>大眾運輸：</strong>YYZ 機場搭 UP Express 至 Union Station，轉 GO Transit 火車/巴士至 Niagara Falls (總程約 2.5–3 小時)。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🌇 18:30 – 20:30｜瀑布前散步 + 景觀晚餐</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>入住瀑布景觀飯店後，可前往 <a href="https://maps.apple.com/?q=Table+Rock+Welcome+Centre" target="_blank">Table Rock Centre</a>，觀察黃昏瀑布光影。</li>
                                    <li><strong>晚餐建議：</strong><a href="https://maps.apple.com/?q=Skylon+Tower,Niagara+Falls" target="_blank" class="hover:underline">Skylon Tower 旋轉餐廳</a> 或 <a href="https://maps.apple.com/?q=The+Keg+Steakhouse,Niagara+Falls" target="_blank" class="hover:underline">The Keg Steakhouse</a>（靠窗位）。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
            <div data-day="6" data-date="2025-07-07" data-day-group="5" data-city-target="niagara-section" data-weather-city="niagara">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 6｜7月7日（一）</p>
                            <h3 id="day6" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">尼加拉瀑布一日體驗｜觀瀑船、煙火、自然景點</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                        <div class="my-3"><span class="tag">#經典體驗</span><span class="tag">#自然奇觀</span><span class="tag">#夜間煙火</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">🌊 09:00 – 12:00｜經典瀑布三合一體驗</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong><a href="https://www.niagaraparks.com/visit/attractions/niagara-city-cruises/" target="_blank" class="hover:underline">Voyage to the Falls 船票體驗</a>：</strong>近距離感受瀑布水勢，建議線上預約上午場。</li>
                                    <li><strong><a href="https://www.niagaraparks.com/visit/attractions/journey-behind-the-falls/" target="_blank" class="hover:underline">Journey Behind the Falls</a>：</strong>進入瀑布後方岩壁隧道觀賞水柱傾瀉。</li>
                                    <li><strong><a href="https://www.niagaraparks.com/visit/attractions/niagaras-fury/" target="_blank" class="hover:underline">Niagara’s Fury 4D 劇場</a>（備選）：</strong>觀看瀑布形成歷史的沉浸式體驗。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🍽 12:30 – 14:00｜午餐建議</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><a href="https://maps.apple.com/?q=Queen+Victoria+Place+Restaurant,Niagara+Falls" target="_blank" class="hover:underline">Queen Victoria Place Restaurant</a>（景觀+當地食材）或 Table Rock Centre 美食廣場。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🦋 14:00 – 17:00｜自然景點探索</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>搭乘 <strong>WEGO 巴士</strong>（建議購買 Niagara Pass）前往：<a href="https://www.niagaraparks.com/visit/attractions/butterfly-conservatory/" target="_blank" class="hover:underline">Butterfly Conservatory</a>（蝴蝶園）或 <a href="https://www.niagaraparks.com/visit/attractions/white-water-walk/" target="_blank" class="hover:underline">White Water Walk</a>（激流步道）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🍷 18:00 – 21:30｜晚餐 + 夜景 + 煙火</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>夜間活動：</strong>約 21:00 起瀑布打燈，21:45～22:00 季節性煙火秀（如天氣良好）。</li>
                                    <li>建議提早至 <a href="https://maps.apple.com/?q=Table+Rock+Welcome+Centre,Niagara+Falls" target="_blank">Table Rock</a> 或 <a href="https://maps.apple.com/?q=Queen+Victoria+Park,Niagara+Falls" target="_blank">Queen Victoria Park</a> 卡位拍照。</li>
                                </ul>
                            </div>
                             <div class="mt-4 p-4 bg-teal-100/60 rounded-lg border-l-4 border-teal-400">
                                <h4 class="font-bold text-teal-800 flex items-center mb-2">⭐ 瀑布實用資訊</h4>
                                <ul class="list-disc list-inside mt-2 text-teal-900/80 space-y-1">
                                    <li>🧥 參加瀑布船與後方通道活動務必攜帶雨衣（現場也會提供）。</li>
                                    <li>🎫 建議提前線上購買 <a href="https://www.niagaraparks.com/visit/attractions/adventure-pass-classic" target="_blank" class="hover:underline">Niagara Pass</a>（含票+WEGO車）避免現場排隊。</li>
                                    <li>📷 相機建議使用防水袋，手機請準備擦拭布。</li>
                                    <li>☀️ 七月氣溫約 25–29°C，日曬強烈建議塗防曬。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
            <section id="chicago-section" data-city-section="chicago-section" class="trip-card"></section>

            <div data-day="7" data-date="2025-07-08" data-day-group="7" data-city-target="chicago-section" data-weather-city="chicago">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="summary-travel-day flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-amber-700">Day 7｜7月8日（二）</p>
                            <h3 id="day7" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">尼加拉瀑布 → 芝加哥｜輕鬆轉移 + 河畔夜色</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                         <div class="my-3"><span class="tag">#跨國飛行</span><span class="tag">#入境美國</span><span class="tag">#芝加哥初印象</span></div>
                        <div class="space-y-6">
                           <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">🧳 08:30 – 10:00｜悠閒早餐 + 退房整備</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>建議睡到自然醒，於飯店內或瀑布區附近享用早餐。</li>
                                    <li>約 10:00 前退房、整裝前往多倫多機場。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🚐 10:00 – 12:00｜前往多倫多皮爾遜機場（YYZ）</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>（時間已提早）</strong>建議包車直達機場，預留充足時間應對路況與美國海關預先清關。</li>
                                </ul>
                            </div>
                             <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">✈️ 15:00 – 16:30｜多倫多 → 芝加哥（ORD）</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>建議航班：</strong>Air Canada AC515（15:00–16:30）或類似班次。</li>
                                    <li>抵達芝加哥 O’Hare 機場後，入境並搭乘地鐵 Blue Line 前往市中心。</li>
                                </ul>
                            </div>
                             <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🌇 18:30 – 21:00｜芝加哥河畔散步 + Deep Dish 晚餐</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>入住飯店後，可沿 <a href="https://maps.apple.com/?q=Chicago+Riverwalk" target="_blank" class="hover:underline">Chicago Riverwalk</a> 散步至 <a href="https://maps.apple.com/?q=DuSable+Bridge,Chicago" target="_blank" class="hover:underline">DuSable Bridge</a>。</li>
                                    <li><strong>晚餐建議：</strong><a href="https://maps.apple.com/?q=Lou+Malnati's,Chicago" target="_blank" class="hover:underline">Lou Malnati’s</a> 或 <a href="https://maps.apple.com/?q=Giordano's,Chicago" target="_blank" class="hover:underline">Giordano’s</a>（芝加哥風味深盤披薩）。</li>
                                </ul>
                            </div>
                             <div class="mt-4 p-4 bg-amber-100/60 rounded-lg border-l-4 border-amber-400">
                                <h4 class="font-bold text-amber-800 flex items-center mb-2">🛏️ 睡前提醒</h4>
                                <ul class="list-disc list-inside mt-2 text-amber-900/80 space-y-1">
                                    <li>明日為建築巡禮與湖濱遊覽日，可自由決定早或晚出發。</li>
                                    <li>若體力充沛，夜間可短暫前往 <a href="https://maps.apple.com/?q=Millennium+Park,Chicago" target="_blank">Millennium Park</a> 看夜色中的 The Bean。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
             <div data-day="8" data-date="2025-07-09" data-day-group="7" data-city-target="chicago-section" data-weather-city="chicago">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 8｜7月9日（三）</p>
                            <h3 id="day8" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">芝加哥建築日｜建築遊船 + 公園藝術 + 湖畔黃昏</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                         <div class="my-3"><span class="tag">#建築遊船</span><span class="tag">#千禧公園</span><span class="tag">#高空夜景</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">🛥️ 09:30 – 12:00｜芝加哥建築遊船 + 千禧公園</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong><a href="https://www.architecture.org/tours/chicago-architecture-foundation-center-river-cruise-aboard-chicago-s-first-lady/" target="_blank" class="hover:underline">Chicago Architecture River Cruise</a>：</strong>建議預約 <a href="https://www.wendellaboats.com/" target="_blank">Wendella</a> 或 <a href="https://www.cruisechicago.com/first-lady-cruises" target="_blank">Chicago’s First Lady</a> 上午場。</li>
                                    <li>遊船後步行至 <a href="https://maps.apple.com/?q=Millennium+Park,Chicago" target="_blank" class="hover:underline">Millennium Park</a> 拍攝 <a href="https://maps.apple.com/?q=Cloud+Gate,Chicago" target="_blank" class="hover:underline">Cloud Gate (The Bean)</a>。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                 <h4 class="font-bold text-lg text-green-800">🍽️ 12:30 – 14:00｜午餐建議</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><a href="https://maps.apple.com/?q=The+Purple+Pig,Chicago" target="_blank" class="hover:underline">The Purple Pig</a>（地中海風味）或 <a href="https://maps.apple.com/?q=Beatrix,Chicago" target="_blank" class="hover:underline">Beatrix</a>（人氣早午餐）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🎡 14:30 – 17:00｜海軍碼頭 Navy Pier + 湖畔活動</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>登上 <a href="https://navypier.org/things-to-do/rides-attractions/centennial-wheel/" target="_blank" class="hover:underline">Centennial Wheel 摩天輪</a>，俯瞰密西根湖與天際線。</li>
                                    <li>或前往<a href="https://mcachicago.org/" target="_blank" class="hover:underline">當代藝術博物館（MCA）</a>。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🌆 18:00 – 21:00｜夜景體驗 + 高空酒吧或觀景塔</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>選擇一：</strong><a href="https://360chicago.com/" target="_blank" class="hover:underline">360 CHICAGO</a>（Hancock Tower），可選附酒吧門票。</li>
                                    <li><strong>選擇二：</strong><a href="https://theskydeck.com/" target="_blank" class="hover:underline">Skydeck Chicago</a>（Willis Tower），體驗懸空玻璃盒。</li>
                                    <li><strong>晚餐：</strong><a href="https://www.signatureroom.com/" target="_blank" class="hover:underline">The Signature Room</a>（Hancock Tower 95樓）或 <a href="https://maps.apple.com/?q=The+Gage,Chicago" target="_blank" class="hover:underline">The Gage</a>。</li>
                                </ul>
                            </div>
                             <div class="mt-4 p-4 bg-teal-100/60 rounded-lg border-l-4 border-teal-400">
                                <h4 class="font-bold text-teal-800 flex items-center mb-2">⭐ 芝加哥實用資訊</h4>
                                <ul class="list-disc list-inside mt-2 text-teal-900/80 space-y-1">
                                    <li>🚇 地鐵系統 CTA 可使用 Ventra App 或現場購票。</li>
                                    <li>📶 網路不穩地點可使用 Starbucks / Target 等店內免費 Wi-Fi。</li>
                                    <li>💨 芝加哥有「風城」之稱，日夜溫差大且湖邊風強，務必攜帶防風外套。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
             <div data-day="9" data-date="2025-07-10" data-day-group="7" data-city-target="chicago-section" data-weather-city="chicago">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 9｜7月10日（週四）</p>
                            <h3 id="day9" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">芝加哥博物館與夜遊河畔日</h3>
                        </div>
                         <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                         <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                         <div class="my-3"><span class="tag">#自然歷史</span><span class="tag">#夜間遊船</span><span class="tag">#城市夜景</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">🦖 09:00 – 12:00｜芝加哥自然歷史博物館（Field Museum）</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                     <li>前往 <a href="https://maps.apple.com/?q=Field+Museum,Chicago" target="_blank" class="hover:underline">Field Museum</a>，重點展覽：Sue 暴龍、古埃及木乃伊、北美原住民。</li>
                                    <li>建議停留約 2.5 小時，可租借語音導覽。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🌳 12:30 – 17:30｜午餐 + 輕鬆行程</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>午餐建議：</strong><a href="https://maps.apple.com/?q=The+Gage,Chicago" target="_blank" class="hover:underline">The Gage</a> 或 <a href="https://maps.apple.com/?q=Wildberry+Pancakes,Chicago" target="_blank" class="hover:underline">Wildberry Pancakes</a>。</li>
                                    <li>下午可至 <a href="https://maps.apple.com/?q=The+Magnificent+Mile,Chicago" target="_blank" class="hover:underline">Magnificent Mile</a> 逛街或在 <a href="https://maps.apple.com/?q=Chicago+Riverwalk" target="_blank" class="hover:underline">Chicago Riverwalk</a> 放鬆。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🌙 18:00 – 21:00｜早晚餐 + 夜間建築遊船</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>晚餐建議：</strong><a href="https://maps.apple.com/?q=The+Dearborn,Chicago" target="_blank" class="hover:underline">The Dearborn</a>（美式餐酒館）或深盤披薩。</li>
                                    <li><strong>夜間建築遊船：</strong>欣賞點燈後的摩天樓，建議選擇 <a href="https://www.wendellaboats.com/" target="_blank">Wendella</a> / <a href="https://www.shorelinesightseeing.com/" target="_blank">Shoreline</a> 等船公司並線上預約。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
            <div data-day="10" data-date="2025-07-11" data-day-group="10" data-city-target="chicago-section" data-weather-city="chicago">
                <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 10｜7月11日（週五）</p>
                            <h3 id="day10" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">芝加哥購物 or 館所自由日</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                        <div class="my-3"><span class="tag">#自由行程</span><span class="tag">#水族館</span><span class="tag">#最後晚餐</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">☀️ 09:00 – 12:00｜自由行程：購物 or 市區散步</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>購物：</strong>前往 <a href="https://maps.apple.com/?q=The+Magnificent+Mile,Chicago" target="_blank" class="hover:underline">Michigan Avenue (Magnificent Mile)</a>，<a href="https://maps.apple.com/?q=Nordstrom,chicago" target="_blank">Nordstrom</a>, <a href="https://maps.apple.com/?q=Macy's,chicago" target="_blank">Macy’s</a>, <a href="https://maps.apple.com/?q=Uniqlo,chicago" target="_blank">Uniqlo</a> 等品牌集中。</li>
                                    <li><strong>散步：</strong>選擇放鬆慢行 <a href="https://maps.apple.com/?q=Millennium+Park,Chicago" target="_blank" class="hover:underline">Millennium Park</a> → <a href="https://maps.apple.com/?q=Maggie+Daley+Park,Chicago" target="_blank" class="hover:underline">Maggie Daley Park</a> 綠地。</li>
                                    <li><strong>藝術：</strong>參觀<a href="https://mcachicago.org/" target="_blank" class="hover:underline">芝加哥當代藝術館（MCA）</a>，小而精緻。</li>
                                </ul>
                            </div>
                             <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🍽️ 12:30 – 14:00｜午餐建議</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><a href="https://maps.apple.com/?q=Beatrix,Chicago" target="_blank" class="hover:underline">Beatrix</a>（輕食系健康料理）或 <a href="https://maps.apple.com/?q=The+Purple+Pig,Chicago" target="_blank" class="hover:underline">The Purple Pig</a>（人氣地中海小酒館）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🐟 14:30 – 17:00｜Shedd Aquarium（水族館）選項</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>前往<a href="https://maps.apple.com/?q=Shedd+Aquarium,Chicago" target="_blank" class="hover:underline">Shedd Aquarium</a>，特展：白鯨、海豚、企鵝、亞馬遜熱帶館區。</li>
                                    <li>若不參觀水族館，也可回飯店休息或繼續購物。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-red-800">🍽️ 18:00 – 20:30｜最後晚餐收尾</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>推薦：</strong><a href="https://maps.apple.com/?q=The+Dearborn,Chicago" target="_blank" class="hover:underline">The Dearborn</a>（現代美式餐酒館）或 <a href="https://maps.apple.com/?q=Cindy's+Rooftop,Chicago" target="_blank" class="hover:underline">Cindy’s Rooftop</a>（觀景餐廳）。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
             
            <div data-day="11" data-date="2025-07-12" data-day-group="10" data-city-target="chicago-section" data-weather-city="chicago">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 11｜7月12日（六）</p>
                            <h3 id="day11" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">芝加哥藝術學院與文化日</h3>
                        </div>
                         <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                         <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                         <div class="my-3"><span class="tag">#藝術巡禮</span><span class="tag">#世界名畫</span><span class="tag">#文化沉浸</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">🎨 09:30 – 13:00｜芝加哥藝術學院（Art Institute of Chicago）</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                     <li>前往<a href="https://www.artic.edu/" target="_blank" class="hover:underline">芝加哥藝術學院</a>，必看莫內《睡蓮》、秀拉《大碗島的星期天下午》、伍德《美國哥德式》。</li>
                                    <li>建議停留 3 小時，可租借語音導覽，深入了解作品。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🍽️ 13:00 – 14:30｜午餐建議</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                     <li><a href="https://maps.apple.com/?q=The+Gage,Chicago" target="_blank" class="hover:underline">The Gage</a>（博物館對面，人氣高）或<a href="https://maps.apple.com/?q=Cindy's+Rooftop,Chicago" target="_blank" class="hover:underline">Cindy’s Rooftop</a>（景觀餐廳）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🛍️ 15:00 onwards｜自由時間</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>可安排購物、回訪喜愛景點或回飯店休息。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
             <div data-day="12" data-date="2025-07-13" data-day-group="10" data-city-target="chicago-section" data-weather-city="chicago">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="flex justify-between items-center">
                        <div class="flex-grow">
                            <p class="text-sm font-medium text-indigo-600">Day 12｜7月13日（日）</p>
                            <h3 id="day12" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">🧳 芝加哥收尾日 + 前往機場</h3>
                        </div>
                        <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                        <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                         <div class="my-3"><span class="tag">#旅程總結</span><span class="tag">#最後巡禮</span><span class="tag">#機場準備</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">☕ 09:00 – 12:00｜早午餐 + 輕鬆散步</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>餐廳建議：</strong><a href="https://maps.apple.com/?q=Wildberry+Pancakes+and+Cafe,Chicago" target="_blank" class="hover:underline">Wildberry Pancakes</a> 或回訪喜愛的餐廳。</li>
                                    <li><strong>行程建議：</strong><a href="https://maps.apple.com/?q=Millennium+Park,Chicago" target="_blank" class="hover:underline">Millennium Park</a> 最後巡禮，或於 <a href="https://maps.apple.com/?q=Chicago+Riverwalk" target="_blank" class="hover:underline">Chicago Riverwalk</a> 散步拍照。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">🎒 12:00 – 17:00｜整理行李 + 自由時間</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>回飯店收拾行李，可向櫃檯請求延後退房或寄存行李。</li>
                                    <li>可至附近商圈採購紀念品（<a href="https://maps.apple.com/?q=Target,Chicago" target="_blank" class="hover:underline">Target</a>、<a href="https://maps.apple.com/?q=Nordstrom+Rack,Chicago" target="_blank" class="hover:underline">Nordstrom Rack</a> 等）。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-purple-800">🧳 18:00 – 21:30｜晚餐 + 前往機場（ORD）</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li>晚餐建議選擇飯店周邊輕食餐廳。</li>
                                    <li>約 21:00 前出發前往 O’Hare 國際機場（ORD）。</li>
                                    <li>可搭乘地鐵 Blue Line 或 Uber，為凌晨航班做準備。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
            <div data-day="13" data-date="2025-07-14" data-day-group="10" data-city-target="">
                 <details class="trip-card bg-white rounded-2xl shadow-lg ring-1 ring-gray-200 overflow-hidden">
                    <summary class="summary-travel-day flex justify-between items-center">
                        <div class="flex-grow">
                           <p class="text-sm font-medium text-amber-700">Day 13-14 | 7/14(一) – 7/15(二)</p>
                            <h3 id="day13" class="text-xl sm:text-2xl font-bold mt-1 text-gray-900">✈️ 返家：芝加哥 → 東京 → 台北</h3>
                        </div>
                         <div class="weather-display flex-shrink-0 ml-4 text-right"></div>
                         <div class="summary-arrow ml-2 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </div>
                    </summary>
                    <div class="p-4 sm:p-6 border-t border-gray-200">
                         <div class="my-3"><span class="tag">#返家之日</span><span class="tag">#跨時區航班</span><span class="tag">#滿載而歸</span></div>
                        <div class="space-y-6">
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-blue-800">Day 13 (週一): 飛行途中</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>航班 JL-009：</strong>01:30 (美國中部時間) 從芝加哥 ORD 機場起飛。</li>
                                    <li>飛行時間約 11 小時 50 分鐘。</li>
                                </ul>
                            </div>
                            <div class="activity-block">
                                <h4 class="font-bold text-lg text-green-800">Day 14 (週二): 轉機並抵達台北</h4>
                                <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                    <li><strong>04:20 (日本時間)：</strong>抵達東京羽田機場 (HND)。</li>
                                    <li><strong>轉機時間：</strong>約 4 小時 35 分鐘。</li>
                                    <li><strong>航班 JL-0097：</strong>08:55 (日本時間) 從羽田機場轉機。</li>
                                    <li><strong>11:35 (台北時間)：</strong>抵達台北松山機場 (TSA)，圓滿結束旅程！</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </details>
            </div>


            <div id="tip-calculator-section">
                <section class="trip-card bg-white rounded-2xl shadow-lg p-6 md:p-8 ring-1 ring-gray-200">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-3.251l-4.71-4.71a1 1 0 00-1.415 0L3 16.251V21h4.75L12 17.25m0 0l6-6m-6 6l-3-3" />
                        </svg>
                        小費計算機 (Tip Calculator)
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                        <div class="col-span-1">
                            <label for="bill-amount" class="block text-sm font-medium text-gray-700">帳單金額 (CAD/USD)</label>
                            <input type="number" id="bill-amount" placeholder="例如 85.50" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        </div>
                        <div class="col-span-1">
                            <label for="tip-rate" class="block text-sm font-medium text-gray-700">小費比例 (%)</label>
                            <select id="tip-rate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                <option value="15">15% (標準)</option>
                                <option value="18" selected>18% (推薦)</option>
                                <option value="20">20% (優質服務)</option>
                                <option value="10">10% (基本)</option>
                            </select>
                        </div>
                        <div class="text-center bg-indigo-50 p-4 rounded-lg mt-4 md:mt-0">
                            <label class="block text-sm font-medium text-gray-700">小費金額</label>
                            <p id="tip-result" class="text-xl font-bold text-indigo-700">-</p>
                        </div>
                         <div class="text-center bg-green-50 p-4 rounded-lg mt-4 md:mt-0">
                            <label class="block text-sm font-medium text-gray-700">含小費總額</label>
                            <p id="total-result" class="text-xl font-bold text-green-700">-</p>
                        </div>
                    </div>
                </section>
            </div>

            <div id="links-dashboard">
                <div class="trip-card bg-white rounded-2xl shadow-lg p-6 md:p-8 ring-1 ring-gray-200">
                     <h2 class="text-2xl sm:text-3xl font-bold mb-6 text-gray-900 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mr-3 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        實用連結儀表板
                    </h2>
                     <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 text-gray-700">
                        <a href="https://www.canada.ca/en/immigration-refugees-citizenship/services/visit-canada/eta/apply-zh-tw.html" target="_blank" class="hover:underline">加拿大eTA官網</a>
                        <a href="https://esta.cbp.dhs.gov/" target="_blank" class="hover:underline">美國ESTA官網</a>
                        <a href="https://www.viarail.ca/en" target="_blank" class="hover:underline">VIA Rail 火車</a>
                        <a href="https://www.basiliquenotredame.ca/en" target="_blank" class="hover:underline">蒙特婁聖母大教堂</a>
                        <a href="https://www.lagranderouedemontreal.com/en" target="_blank" class="hover:underline">蒙特婁摩天輪</a>
                        <a href="https://www.mcq.org/en/" target="_blank" class="hover:underline">魁北克文明博物館</a>
                        <a href="https://www.niagaraparks.com/visit/attractions/adventure-pass-classic" target="_blank" class="hover:underline">尼加拉瀑布套票</a>
                        <a href="https://www.theskydeck.com/" target="_blank" class="hover:underline">芝加哥Skydeck</a>
                        <a href="https://www.artic.edu/" target="_blank" class="hover:underline">芝加哥藝術學院</a>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="text-center mt-16 py-8">
            <p class="text-gray-500">祝您旅途愉快！Bon Voyage!</p>
        </footer>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast-notification" class="no-print hidden opacity-0 fixed bottom-24 right-4 bg-gray-800 text-white px-5 py-3 rounded-lg shadow-xl transition-all duration-300 z-[100]">
        <p id="toast-message"></p>
    </div>

    <!-- "Today's Itinerary" Button -->
    <div class="no-print fixed bottom-4 right-4 z-50">
        <button id="today-btn" onclick="scrollToToday()" class="bg-amber-500 text-white font-semibold px-4 py-3 rounded-full shadow-lg hover:bg-amber-600 transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-400 flex items-center justify-center">
            📅 今天行程
        </button>
    </div>
    
    <script>
        // --- Global Functions (callable from HTML onclick) ---

        /**
         * Shows a toast notification with a message.
         * @param {string} message The message to display.
         */
        let toastTimeout;
        function showToast(message) {
            const toastEl = document.getElementById('toast-notification');
            const toastMessageEl = document.getElementById('toast-message');
            if (!toastEl || !toastMessageEl) return;
            
            toastMessageEl.textContent = message;
            toastEl.classList.remove('hidden', 'opacity-0');
            
            clearTimeout(toastTimeout);
            toastTimeout = setTimeout(() => {
                toastEl.classList.add('opacity-0');
                setTimeout(() => toastEl.classList.add('hidden'), 300);
            }, 3000);
        }

        /**
         * Finds today's itinerary item, scrolls to it, and expands it.
         * @param {boolean} isAuto - True if called automatically on page load.
         */
        function scrollToToday(isAuto = false) {
            const todaySummary = document.querySelector('.summary-today');
            
            if (todaySummary) {
                const todayElement = todaySummary.closest('[data-day]');
                if (!todayElement) return;

                const details = todayElement.querySelector('details');
                if (details && !details.open) {
                    details.open = true;
                }

                const mainNav = document.getElementById('main-nav');
                const offset = mainNav ? mainNav.offsetHeight : 60;
                const bodyRect = document.body.getBoundingClientRect().top;
                const elementRect = todayElement.getBoundingClientRect().top;
                const elementPosition = elementRect - bodyRect;
                const offsetPosition = elementPosition - offset - 20;

                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });

                if (!isAuto) {
                    const dateStr = todayElement.dataset.date;
                    const date = dateStr ? dateStr.substring(5).replace('-', '/') : '今天';
                    showToast(`已為您跳轉至 ${date} 的行程！`);
                }
            } else {
                 if (!isAuto) {
                    showToast('今天不在行程日期範圍內喔！');
                 }
            }
        }


        // --- Main script execution after DOM is loaded ---
        document.addEventListener('DOMContentLoaded', () => {

            const mainNav = document.getElementById('main-nav');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenuPanel = document.getElementById('mobile-menu-panel');
            
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', () => {
                    if (mobileMenuPanel) mobileMenuPanel.classList.toggle('hidden');
                });
            }
            
            window.addEventListener('scroll', () => {
                if(mainNav) mainNav.classList.toggle('scrolled', window.scrollY > 0);
            });

            const tripCards = document.querySelectorAll('.trip-card');
            const cardObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        const activityBlocks = entry.target.querySelectorAll('.activity-block');
                        activityBlocks.forEach((block, index) => {
                            block.style.transitionDelay = `${index * 120}ms`;
                        });
                    }
                });
            }, { threshold: 0.1 });
            tripCards.forEach(card => cardObserver.observe(card));

            const desktopNavPills = document.querySelectorAll('#desktop-nav-pills .nav-pill');
            const daysContent = document.getElementById('desktop-nav-content-days');
            const citiesContent = document.getElementById('desktop-nav-content-cities');
            
            desktopNavPills.forEach(pill => {
                pill.addEventListener('click', () => {
                    desktopNavPills.forEach(p => p.classList.remove('active'));
                    pill.classList.add('active');
                    const isCityTab = pill.dataset.tab === 'cities';
                    if (daysContent) daysContent.classList.toggle('hidden', isCityTab);
                    if (citiesContent) {
                        citiesContent.classList.toggle('hidden', !isCityTab);
                        citiesContent.classList.toggle('flex', isCityTab);
                    }
                });
            });

            function handleNavigation(hash) {
                if (!hash || hash === '#') return;
                try {
                    const targetElement = document.querySelector(hash);
                    if (!targetElement) return;

                    // NEW: Smartly handle past itinerary clicks from map
                    const toggle = document.getElementById('show-past-toggle');
                    if (targetElement.hasAttribute('data-city-section') && toggle && !toggle.checked) {
                        const cityId = targetElement.id;
                        const hasPastDay = !!document.querySelector(`[data-city-target="${cityId}"].day-past`);

                        if (hasPastDay) {
                            toggle.checked = true;
                            toggle.dispatchEvent(new Event('change'));
                            showToast('為您顯示過去行程以查看目的地');
                        }
                    }
                    
                    const offset = mainNav ? mainNav.offsetHeight + 20 : 80;
                    const targetTop = targetElement.getBoundingClientRect().top + window.pageYOffset;
                     window.scrollTo({
                        top: targetTop - offset,
                        behavior: 'smooth'
                    });

                    if (targetElement.hasAttribute('data-city-section')) {
                        let nextElement = targetElement.nextElementSibling;
                        while (nextElement && !nextElement.hasAttribute('data-city-section')) {
                            if (nextElement.dataset.cityTarget === targetElement.id) {
                                const details = nextElement.querySelector('details');
                                if (details && !details.open) details.open = true;
                            }
                            nextElement = nextElement.nextElementSibling;
                        }
                    } else {
                        const details = targetElement.closest('details');
                        if (details && !details.open) details.open = true;
                    }
                } catch (e) {
                    console.error("Navigation error:", e);
                }
            }
            
            document.querySelectorAll('a[href^="#"], .nav-utils').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const hash = this.getAttribute('href');
                    handleNavigation(hash);
                    if (history.pushState) {
                        history.pushState(null, null, hash);
                    } else {
                        location.hash = hash;
                    }
                    if (mobileMenuPanel && !mobileMenuPanel.classList.contains('hidden')) {
                        mobileMenuPanel.classList.add('hidden');
                    }
                });
            });

            if (window.location.hash) {
                setTimeout(() => handleNavigation(window.location.hash), 100);
            }
            
            document.querySelectorAll('.mobile-nav-link').forEach(link => {
                link.addEventListener('click', () => {
                     if(mobileMenuPanel) mobileMenuPanel.classList.add('hidden');
                });
            });
            
            const mapCityLinks = document.querySelectorAll('.map-city-link');
            const mapRouteLines = document.querySelectorAll('.route-line');
            const dayCards = document.querySelectorAll('[data-city-target]');

            mapCityLinks.forEach(link => {
                if (!link.dataset.pathId) return;
                const pathIds = link.dataset.pathId.split(',');
                
                const highlight = () => pathIds.forEach(id => document.getElementById(id)?.classList.add('highlight'));
                const unhighlight = () => pathIds.forEach(id => document.getElementById(id)?.classList.remove('highlight'));

                link.addEventListener('mouseenter', highlight);
                link.addEventListener('mouseleave', unhighlight);
            });

            const mapHighlightObserver = new IntersectionObserver((entries) => {
                mapCityLinks.forEach(link => link.classList.remove('map-city-active'));
                mapRouteLines.forEach(line => line.classList.remove('highlight-scroll'));
                
                const intersectingEntries = entries.filter(e => e.isIntersecting);
                if (intersectingEntries.length > 0) {
                    const latestActiveCity = intersectingEntries[intersectingEntries.length - 1].target.dataset.cityTarget;
                     mapCityLinks.forEach(link => {
                        if (link.dataset.cityId === latestActiveCity) {
                            link.classList.add('map-city-active');
                            const pathIds = link.dataset.pathId.split(',');
                            pathIds.forEach(id => document.getElementById(id)?.classList.add('highlight-scroll'));
                        }
                    });
                }
            }, { rootMargin: `-${mainNav ? mainNav.offsetHeight : 60}px 0px -60% 0px`, threshold: 0 });

            dayCards.forEach(card => {
                if (card.dataset.cityTarget) mapHighlightObserver.observe(card);
            });


            function triggerPrint() {
                const allDetails = document.querySelectorAll('details');
                const originallyOpen = new WeakMap();
                allDetails.forEach(detail => {
                    originallyOpen.set(detail, detail.open);
                    detail.open = true;
                });
                setTimeout(() => {
                    window.print();
                    allDetails.forEach(detail => {
                        detail.open = originallyOpen.get(detail);
                    });
                }, 100);
            }
            document.getElementById('print-btn')?.addEventListener('click', triggerPrint);
            document.getElementById('mobile-print-btn')?.addEventListener('click', triggerPrint);


            const billInput = document.getElementById('bill-amount');
            const tipSelect = document.getElementById('tip-rate');
            const tipResultEl = document.getElementById('tip-result');
            const totalResultEl = document.getElementById('total-result');

            function calculateTip() {
                const bill = parseFloat(billInput.value);
                const tipPercent = parseFloat(tipSelect.value);
                
                if (!isNaN(bill) && bill > 0 && !isNaN(tipPercent)) {
                    const tip = bill * (tipPercent / 100);
                    const total = bill + tip;
                    if(tipResultEl) tipResultEl.textContent = `$${tip.toFixed(2)}`;
                    if(totalResultEl) totalResultEl.textContent = `$${total.toFixed(2)}`;
                } else {
                    if(tipResultEl) tipResultEl.textContent = '-';
                    if(totalResultEl) totalResultEl.textContent = '-';
                }
            }
            if (billInput) billInput.addEventListener('input', calculateTip);
            if (tipSelect) tipSelect.addEventListener('change', calculateTip);

            function updateClocks() {
                const now = new Date();
                const timezones = {
                    montreal: 'America/Montreal',
                    chicago: 'America/Chicago',
                    taipei: 'Asia/Taipei'
                };

                for (const [id, tz] of Object.entries(timezones)) {
                    const timeEl = document.getElementById(`time-${id}`);
                    const dateEl = document.getElementById(`date-${id}`);
                    if (timeEl && dateEl) {
                        try {
                            timeEl.textContent = now.toLocaleTimeString('en-GB', { timeZone: tz, hour12: false });
                            dateEl.textContent = now.toLocaleDateString('zh-TW', { timeZone: tz, weekday: 'long' });
                        } catch (e) {
                            timeEl.textContent = "N/A";
                            dateEl.textContent = "時區錯誤";
                        }
                    }
                }
            }

            const cityCoordinates = {
                montreal: { lat: 45.50, lon: -73.57 },
                quebec: { lat: 46.81, lon: -71.21 },
                niagara: { lat: 43.09, lon: -79.08 },
                chicago: { lat: 41.88, lon: -87.63 }
            };

            function getWeatherIcon(code) {
                const icons = { 0: '☀️', 1: '🌤️', 2: '⛅️', 3: '☁️', 45: '🌫️', 48: '🌫️', 51: '🌦️', 53: '🌦️', 55: '🌦️', 61: '🌧️', 63: '🌧️', 65: '🌧️', 66: '🌧️', 67: '🌧️', 71: '🌨️', 73: '🌨️', 75: '🌨️', 77: '🌨️', 80: '🌧️', 81: '🌧️', 82: '暴雨', 85: '🌨️', 86: '🌨️', 95: '⛈️', 96: '⛈️', 99: '⛈️' };
                return icons[code] || '🌡️';
            }

            async function fetchAndDisplayWeather() {
                const dayElements = document.querySelectorAll('[data-weather-city]');
                const promises = Array.from(new Set(Array.from(dayElements).map(el => el.dataset.weatherCity)))
                    .filter(Boolean)
                    .map(city => {
                        const { lat, lon } = cityCoordinates[city];
                        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weather_code,temperature_2m_max&timezone=auto`;
                        return fetch(url).then(res => res.json()).then(data => ({ city, data }));
                    });

                const results = await Promise.all(promises);
                const weatherData = results.reduce((acc, {city, data}) => ({ ...acc, [city]: data.daily }), {});
                
                dayElements.forEach(dayEl => {
                    const date = dayEl.dataset.date;
                    const city = dayEl.dataset.weatherCity;
                    const weatherDisplay = dayEl.querySelector('.weather-display');
                    if (city && weatherData[city] && weatherDisplay) {
                        const dayIndex = weatherData[city].time.indexOf(date);
                        if (dayIndex !== -1) {
                            const temp = Math.round(weatherData[city].temperature_2m_max[dayIndex]);
                            const icon = getWeatherIcon(weatherData[city].weather_code[dayIndex]);
                            weatherDisplay.innerHTML = `${icon} ${temp}°C`;
                        } else {
                             weatherDisplay.textContent = '暫無預報';
                        }
                    }
                });
            }
            
            // --- Robust Date and View Management ---
            function initializeTripView() {
                const showPastToggle = document.getElementById('show-past-toggle');
                const mainContainer = document.querySelector('main.space-y-8');
                if (!mainContainer || !showPastToggle) return;
                
                // Store original titles
                const timezoneTitles = {
                    'time-montreal-block': document.querySelector('#time-montreal-block h2'),
                    'time-chicago-block': document.querySelector('#time-chicago-block h2'),
                    'time-taipei-block': document.querySelector('#time-taipei-block h2'),
                };
                const originalTitles = {};
                for(const id in timezoneTitles) {
                    if(timezoneTitles[id]) originalTitles[id] = timezoneTitles[id].textContent;
                }


                showPastToggle.checked = false;

                const getTodayString = () => {
                    const today = new Date();
                    const year = today.getFullYear();
                    const month = String(today.getMonth() + 1).padStart(2, '0');
                    const day = String(today.getDate()).padStart(2, '0');
                    return `${year}-${month}-${day}`;
                };
                const todayString = getTodayString();

                let todayElement = null;
                let todayCityTargetId = null;
                let todayWeatherCity = null;

                document.querySelectorAll('[data-date]').forEach(el => {
                    const dateStr = el.dataset.date;
                    if (!dateStr) return;
                    
                    el.classList.remove('day-past');
                    const summary = el.querySelector('summary');
                    if (summary) summary.classList.remove('summary-today');
                    
                    if (dateStr < todayString) {
                        el.classList.add('day-past');
                        if (el.querySelector('details')) el.querySelector('details').open = false;
                    } else if (dateStr === todayString) {
                        todayElement = el;
                        todayCityTargetId = el.dataset.cityTarget;
                        todayWeatherCity = el.dataset.weatherCity;

                        const summaryElement = el.querySelector('summary');
                        if (summaryElement) {
                            summaryElement.classList.add('summary-today');
                            const h3 = summaryElement.querySelector('h3');
                            const marker = h3?.querySelector('.today-marker');
                            if(h3 && !marker) {
                                h3.insertAdjacentHTML('beforeend', ' <span class="today-marker text-base font-medium text-green-600">(今日行程)</span>');
                            }
                        }
                    }
                });
                
                document.querySelectorAll('.map-city-link').forEach(link => link.classList.remove('map-city-current'));
                if (todayCityTargetId) {
                    const currentCityLink = document.querySelector(`.map-city-link[data-city-id="${todayCityTargetId}"]`);
                    currentCityLink?.classList.add('map-city-current');
                }

                // --- DYNAMIC HIGHLIGHT LOGIC ---
                document.querySelectorAll('.timezone-block').forEach(block => block.classList.remove('timezone-highlight'));
                for(const id in timezoneTitles) {
                    if(timezoneTitles[id] && originalTitles[id]) timezoneTitles[id].textContent = originalTitles[id];
                }

                let highlightBlockId = 'time-taipei-block';
                if (todayWeatherCity) {
                    const eastern = ['montreal', 'quebec', 'niagara'];
                    if (eastern.includes(todayWeatherCity)) {
                        highlightBlockId = 'time-montreal-block';
                    } else if (todayWeatherCity === 'chicago') {
                        highlightBlockId = 'time-chicago-block';
                    }
                }
                
                const blockToHighlight = document.getElementById(highlightBlockId);
                const titleToUpdate = timezoneTitles[highlightBlockId];
                if (blockToHighlight && titleToUpdate) {
                    blockToHighlight.classList.add('timezone-highlight');
                    titleToUpdate.textContent = `${originalTitles[highlightBlockId]} (當地)`;
                }

                const updateVisibility = () => mainContainer.classList.toggle('show-past', showPastToggle.checked);
                showPastToggle.addEventListener('change', updateVisibility);
                updateVisibility();

                if (todayElement && !window.location.hash) {
                    setTimeout(() => scrollToToday(true), 500);
                }
            }

            // --- Initial Calls ---
            updateClocks();
            setInterval(updateClocks, 1000);
            fetchAndDisplayWeather();
            initializeTripView();

        }); // End of DOMContentLoaded
    </script>
</body>
</html>
